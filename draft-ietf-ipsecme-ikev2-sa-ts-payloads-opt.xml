<?xml version='1.0' encoding='utf-8'?>
<!DOCTYPE rfc [
  <!ENTITY nbsp    "&#160;">
  <!ENTITY zwsp   "&#8203;">
  <!ENTITY nbhy   "&#8209;">
  <!ENTITY wj     "&#8288;">
]>
<?xml-stylesheet type="text/xsl" href="rfc2629.xslt" ?>
<!-- generated by https://github.com/cabo/kramdown-rfc version 1.7.24 (Ruby 3.2.3) -->
<rfc xmlns:xi="http://www.w3.org/2001/XInclude" ipr="trust200902" docName="draft-ietf-ipsecme-ikev2-sa-ts-payloads-opt-04" category="std" consensus="true" submissionType="IETF" tocInclude="true" sortRefs="true" symRefs="true" version="3">
  <!-- xml2rfc v2v3 conversion 3.28.0 -->
  <front>
    <title abbrev="Optimized Rekey of IKE &amp; Child SAs">Optimized Rekeys in the Internet Key Exchange Protocol Version 2 (IKEv2)</title>
    <seriesInfo name="Internet-Draft" value="draft-ietf-ipsecme-ikev2-sa-ts-payloads-opt-04"/>
    <author initials="S." surname="Kampati" fullname="Sandeep Kampati">
      <organization abbrev="Microsoft">Microsoft</organization>
      <address>
        <postal>
          <country>India</country>
        </postal>
        <email>skampati@microsoft.com</email>
      </address>
    </author>
    <author initials="W." surname="Pan" fullname="Wei Pan">
      <organization abbrev="Huawei">Huawei Technologies</organization>
      <address>
        <postal>
          <street>101 Software Avenue, Yuhuatai District</street>
          <city>Nanjing</city>
          <region>Jiangsu</region>
          <code/>
          <country>China</country>
        </postal>
        <email>william.panwei@huawei.com</email>
      </address>
    </author>
    <author initials="P." surname="Wouters" fullname="Paul Wouters">
      <organization abbrev="Aiven">Aiven</organization>
      <address>
        <email>paul.wouters@aiven.io</email>
      </address>
    </author>
    <author initials="M." surname="Bharath" fullname="Meduri S S Bharath">
      <organization abbrev="Mavenir">Mavenir Systems Pvt Ltd</organization>
      <address>
        <postal>
          <street>Manyata Tech Park</street>
          <city>Bangalore</city>
          <region>Karnataka</region>
          <code/>
          <country>India</country>
        </postal>
        <email>bharath.meduri@mavenir.com</email>
      </address>
    </author>
    <author initials="M." surname="Chen" fullname="Meiling Chen">
      <organization abbrev="CMCC">China Mobile</organization>
      <address>
        <postal>
          <street>32 Xuanwumen West Street, West District</street>
          <city>Beijing</city>
          <code>100053</code>
          <country>China</country>
        </postal>
        <email>chenmeiling@chinamobile.com</email>
      </address>
    </author>
    <author initials="V." surname="Smyslov" fullname="Valery Smyslov">
      <organization abbrev="ELVIS-PLUS">ELVIS-PLUS</organization>
      <address>
        <postal>
          <street>PO Box 81</street>
          <city>Moscow (Zelenograd)</city>
          <code>124460</code>
          <country>Russian Federation</country>
        </postal>
        <phone>+7 495 276 0211</phone>
        <email>svan@elvis.ru</email>
      </address>
    </author>
    <date year="2025" month="March" day="03"/>
    <area>Security</area>
    <workgroup>IPSECME Working Group</workgroup>
    <keyword>Internet-Draft</keyword>
    <abstract>
      <?line 87?>

<t>This document describes a method for reducing the size of the Internet Key Exchange version 2 (IKEv2) CREATE_CHILD_SA exchanges used for rekeying of the IKE or Child SA by replacing the SA and TS payloads with a Notify Message payload.
Reducing size and complexity of IKEv2 exchanges is especially useful for low power consumption battery powered devices.</t>
    </abstract>
    <note removeInRFC="true">
      <name>About This Document</name>
      <t>
        Status information for this document may be found at <eref target="https://datatracker.ietf.org/doc/draft-ietf-ipsecme-ikev2-sa-ts-payloads-opt/"/>.
      </t>
      <t>
        Discussion of this document takes place on the
        ipsec Working Group mailing list (<eref target="mailto:ipsec@ietf.org"/>),
        which is archived at <eref target="https://mailarchive.ietf.org/arch/browse/ipsec/"/>.
        Subscribe at <eref target="https://www.ietf.org/mailman/listinfo/ipsec/"/>.
      </t>
    </note>
  </front>
  <middle>
    <?line 92?>

<section anchor="introduction">
      <name>Introduction</name>
      <t>The Internet Key Exchange protocol version 2 (IKEv2) <xref target="RFC7296"/> is used to negotiate Security Association (SA) parameters for the IKE SA and the Child SAs. Cryptographic key material for these SAs have a limited lifetime before it needs to be refreshed, a process referred to as "rekeying". IKEv2 uses the CREATE_CHILD_SA exchange to rekey either the IKE SA or the Child SAs.</t>
      <t>When rekeying, a full set of negotiation parameters are exchanged. However, most of these parameters will be the same as before. This means that the security properties of the IKE or Child SA in practice do not change during a typical rekey.</t>
      <t>For example, the Traffic Selectors (TS) negotiated for the new Child SA must cover the Traffic Selectors negotiated for the old Child SA. And in practically all cases, a new Child SA does not need to cover a wider set of traffic. In the rare case where this would be needed, either a standard rekey could be used or a new Child SA could be negotiated followed by a deletion of the replaced Child SA. Further, per RFC 7296, the Traffic Selectors and algorithms should not change when rekeying the Child SA.</t>
      <t>This document specifies a method to omit these parameters and replace them with a single Notify Message declaring that all these parameters are identical to the originally negotiated parameters.</t>
      <t>Large scale IKEv2 gateways such as Evolved Packet Data Gateway (ePDG) in 4G networks or Centralized Radio Access Network (cRAN/Cloud) gateways in 5G networks typically support more than 100,000 IKE/IPsec connections. At any point in time, there will be hundreds or thousands of IKE SAs and Child SAs that are being rekeyed. This takes a large amount of bandwidth and CPU power and any protocol simplification or bandwidth reducing would result in a significant resource saving.</t>
      <t>For Internet of Things (IoT) devices which utilize low power consumption technology, reducing the size of the CREATE_CHILD_SA exchange for rekeying reduces its power consumption, as sending bytes over the air is usually the most power consuming operation of such a device. Reducing the CPU operations required to verify the rekey exchanges parameters will also save power and extend the lifetime for these devices.</t>
      <t>When using identical parameters for the IKE SA or Child SA rekey, the SA and TS payloads can be omitted thanks to the optimization defined in this document. For an IKE SA rekey, instead of the (large) SA payload, only a Key Exchange (KE) payload, a Nonce payload, and a new Notify Type payload with the new Security Parameter Index (SPI) are required. For a Child SA rekey, instead of the SA or TS payloads, only an optional KE payload (when using PFS), a Nonce payload, and a new Notify Type payload with the new SPI are needed. This makes the rekey exchange packets much smaller and the peers do not need to verify that the SA or TS parameters are compatible with the old SA parameters.</t>
    </section>
    <section anchor="conventions-used-in-this-document">
      <name>Conventions Used in This Document</name>
      <section anchor="requirements-language">
        <name>Requirements Language</name>
        <t>The key words "<bcp14>MUST</bcp14>", "<bcp14>MUST NOT</bcp14>", "<bcp14>REQUIRED</bcp14>", "<bcp14>SHALL</bcp14>", "<bcp14>SHALL
NOT</bcp14>", "<bcp14>SHOULD</bcp14>", "<bcp14>SHOULD NOT</bcp14>", "<bcp14>RECOMMENDED</bcp14>", "<bcp14>NOT RECOMMENDED</bcp14>",
"<bcp14>MAY</bcp14>", and "<bcp14>OPTIONAL</bcp14>" in this document are to be interpreted as
described in BCPÂ 14 <xref target="RFC2119"/> <xref target="RFC8174"/> when, and only when, they
appear in all capitals, as shown here.</t>
        <?line -18?>

</section>
    </section>
    <section anchor="negotiation-of-support-for-optimized-rekey">
      <name>Negotiation of Support for Optimized Rekey</name>
      <t>To indicate support for the optimized rekey negotiation, the initiator includes the OPTIMIZED_REKEY_SUPPORTED notify payload in the IKE_AUTH exchange request.
If the responder supports this optimized rekey and is configured to use it, then it includes the OPTIMIZED_REKEY_SUPPORTED in the IKE_AUTH response message.
If multiple IKE_AUTH exchanges are sent, the OPTIMIZED_REKEY_SUPPORTED notify payload should be in the first IKE_AUTH request and the last IKE_AUTH response.
During the IKE_AUTH exchanges, the entire SA and TS payloads are included as normal. Note that the notify indicates support for optimized rekey for both IKE and Child SAs.</t>
      <t>A responder that does not support the optimized rekey exchange processes the SA and TS payloads as normal, and does not include the new Notify. As per regular IKEv2 processing, a responder that does not recognize this new Notify, will ignore it. Responders may have been administratively configured with the optimization turned off for local reasons. The absence of the Notify indicates to the initiator that the optimization is not available, and regular rekey should be used.</t>
      <t>The IKE_AUTH message exchange in this case is shown below:</t>
      <artwork><![CDATA[
Initiator                       Responder
--------------------------------------------------------------------
HDR, SK {IDi, [CERT,] [CERTREQ,]
    [IDr,] AUTH, SAi2, TSi, TSr,
    N(OPTIMIZED_REKEY_SUPPORTED)} -->
                            <-- HDR, SK {IDr, [CERT,] AUTH,
                                    SAr2, TSi, TSr,
                                    N(OPTIMIZED_REKEY_SUPPORTED)}
]]></artwork>
      <t>If both peers have exchanged OPTIMIZED_REKEY_SUPPORTED notifies, peers <bcp14>SHOULD</bcp14> use the optimized rekey method for rekeys.
Non-optimized, regular rekey requests <bcp14>MUST</bcp14> always be accepted.
The regular rekey can be retried when the optimized rekey fails.</t>
      <t>Note that, except for the key and identification information such as the SPI, the optimized rekey <bcp14>MUST</bcp14> inherit all other properties of the SA being rekeyed.
This means the configurations related to the SA being rekeyed are supposed to have no changes.
If there is a change to the configurations, the regular rekey <bcp14>MUST</bcp14> be used instead.
After the regular rekey, the next rekey can use the optimized way if there is no change to the configuration.</t>
    </section>
    <section anchor="optimized-rekey-of-ike-sa">
      <name>Optimized Rekey of IKE SA</name>
      <t>The initiator of an optimized rekey request sends a CREATE_CHILD_SA request with the OPTIMIZED_REKEY notify payload containing the new SPI for the new IKE SA. It omits the SA payload.</t>
      <t>The responder of an optimized rekey request replies with an included OPTIMIZED_REKEY notify with its new IKE SPI and also omits the SA payload.</t>
      <t>Both parties send their nonce and KE payloads just as they would do for a regular IKE SA rekey.</t>
      <t>Using the old SPI from the IKE header and the two new SPIs respectively from the initiator and responder's OPTIMIZED_REKEY payloads, both parties can perform the IKE SA rekey operation.</t>
      <t>The CREATE_CHILD_SA message exchange in this case is shown below:</t>
      <artwork><![CDATA[
Initiator                       Responder
--------------------------------------------------------------------
HDR, SK {N(OPTIMIZED_REKEY,newSPIi),
         Ni, KEi} -->
                            <-- HDR, SK {N(OPTIMIZED_REKEY,newSPIr),
                                         Nr, KEr}
]]></artwork>
    </section>
    <section anchor="optimized-rekey-of-child-sas">
      <name>Optimized Rekey of Child SAs</name>
      <t>The initiator of an optimized rekey request sends a CREATE_CHILD_SA request with the OPTIMIZED_REKEY notify payload containing the new SPI for the new Child SA.
It omits the SA and TS payloads.
If the Child SA being rekeyed was negotiated with Perfect Forward Secrecy (PFS), a KEi payload is included as well.
If no PFS was negotiated for the Child SA being rekeyed, a KEi payload is not included.
If the Child SA being rekeyed was created with IP compression, then IPCOMP_SUPPORTED notifications <bcp14>MUST</bcp14> be sent as they contain the required updated Compression Parameter Indexes (CPIs).</t>
      <t>The responder of an optimized rekey request performs the same process. It includes the OPTIMIZED_REKEY notify with its new SPI for the new Child SA and omits the SA and TS payloads. Depending on the PFS and IP compression negotiation of the Child SA being rekeyed, the responder correspondingly includes a KEr payload and/or the IPCOMP_SUPPORTED Notify payload.</t>
      <t>Both parties send their nonce payloads just as they would do for a regular Child SA rekey.</t>
      <t>Using the old SPI from the REKEY_SA payload and the two new SPIs respectively from the initiator and responder's OPTIMIZED_REKEY payloads, both parties can perform the Child SA rekey operation.</t>
      <t>Except for the key and identification information such as the SPI and CPI, all other properties of the Child SA being rekeyed <bcp14>MUST</bcp14> be inherited to the one newly created by the optimized rekey. Notify payloads that can affect these properties, such as USE_TRANSPORT_MODE, ESP_TFC_PADDING_NOT_SUPPORTED, ROHC_SUPPORTED <xref target="RFC5857"/> or USE_AGGFRAG <xref target="RFC9347"/> <bcp14>MUST NOT</bcp14> be sent.</t>
      <t>The CREATE_CHILD_SA message exchange in this case is shown below:</t>
      <artwork><![CDATA[
Initiator                       Responder
--------------------------------------------------------------------
HDR, SK {N(REKEY_SA,oldSPI), N(OPTIMIZED_REKEY,newSPIi),
         Ni, [KEi,]} -->
                            <-- HDR, SK {N(OPTIMIZED_REKEY,newSPIr),
                                         Nr, [KEr,]}
]]></artwork>
      <t>For the initial Child SA that was negotiated as part of an initial IKE exchange (e.g., IKE_AUTH), at the time of its creation the parameters of PFS and KE method for Child SAs are not negotiated. Therefore, the KE method for the initial IKE SA should also be recognized as the one for this initial Child SA.</t>
      <t>Two peers must have the same configurations for the parameters of PFS and KE method for Child SAs.</t>
      <t>If rekeying without PFS is required, the peer initiates the optimized rekey request without a KEi payload.
If rekeying with PFS is required and the configured KE method for Child SAs is the same as the one used by the Child SA being rekeyed, the peer initiates the optimized rekey request with a KEi payload. The responder correspondingly includes a KEr payload or not in its optimized rekey response.</t>
      <t>If the configured KE method for Child SAs is different from the one used by the Child SA being rekeyed, this situation can be seen as there is a configuration change, thus the regular rekey should be used instead of the optimized rekey.</t>
      <t>If the responder fails to process the optimized rekey request, e.g., receiving a request with a non-allowed PFS proposal, it <bcp14>MUST</bcp14> return an error as the notification of type NO_PROPOSAL_CHOSEN. After receiving the error response of the optimized rekey, the initiator can retry a regular rekey.</t>
    </section>
    <section anchor="payload-formats">
      <name>Payload Formats</name>
      <section anchor="optimizedrekeysupported-notify">
        <name>OPTIMIZED_REKEY_SUPPORTED Notify</name>
        <t>The OPTIMIZED_REKEY_SUPPORTED Notify Message type notification is used by the initiator and responder to indicate their support for the optimized rekey negotiation.</t>
        <artwork><![CDATA[
                     1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+-+-------------+-------------------------------+
| Next Payload  |C|  RESERVED   |         Payload Length        |
+---------------+-+-------------+-------------------------------+
|Protocol ID(=0)| SPI Size (=0) |      Notify Message Type      |
+---------------+---------------+-------------------------------+
]]></artwork>
        <ul spacing="normal">
          <li>
            <t>Protocol ID (1 octet) - <bcp14>MUST</bcp14> be 0.</t>
          </li>
          <li>
            <t>SPI Size (1 octet) - <bcp14>MUST</bcp14> be 0, meaning no SPI is present.</t>
          </li>
          <li>
            <t>Notify Message Type (2 octets) - <bcp14>MUST</bcp14> be set to the value <tt>TBD1</tt>.</t>
          </li>
        </ul>
        <t>This Notify Message type contains no data.</t>
      </section>
      <section anchor="optimizedrekey-notify">
        <name>OPTIMIZED_REKEY Notify</name>
        <t>The OPTIMIZED_REKEY Notify Message type is used to perform an optimized IKE SA or Child SA rekey.</t>
        <artwork><![CDATA[
 0                 1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+-+-------------+-------------------------------+
| Next Payload  |C|  RESERVED   |         Payload Length        |
+---------------+-+-------------+-------------------------------+
|Protocol ID(=0)| SPI Size (=0) |      Notify Message Type      |
+---------------+---------------+-------------------------------+
|                                                               |
~                            New SPI                            ~
|                                                               |
+---------------------------------------------------------------+
]]></artwork>
        <ul spacing="normal">
          <li>
            <t>Protocol ID (1 octet) - <bcp14>MUST</bcp14> be 0.</t>
          </li>
          <li>
            <t>SPI Size (1 octet) - <bcp14>MUST</bcp14> be 0. The "Security Parameter Index (SPI)" field is not used in this Notify, and the new SPI is placed in the "Notification Data" field.</t>
          </li>
          <li>
            <t>Notify Message Type (2 octets) - <bcp14>MUST</bcp14> be set to the value <tt>TBD2</tt>.</t>
          </li>
        </ul>
        <t>The Notification Data for this notify contains new SPI. Its size depends on the type of SA being rekeyed. In case of IKE SA it <bcp14>MUST</bcp14> be 8 octets. In case of Child SA it <bcp14>MUST</bcp14> be equal to the SPI Size field in the REKEY_SA notification that identifies the SA being rekeyed.</t>
      </section>
    </section>
    <section anchor="interaction-with-ikev2-extensions">
      <name>Interaction with IKEv2 Extensions</name>
      <section anchor="multiple-key-exchanges">
        <name>Multiple Key Exchanges</name>
        <t><xref target="RFC9370"/> defines the use of multiple key exchange methods for the purpose of IKE SA and Child SA establishment in IKEv2. If multiple key exchange methods are used for an SA, then optimized rekey of this SA <bcp14>MUST</bcp14> use the same key exchange methods. It means that the CREATE_CHILD_SA will be followed by some IKE_FOLLOWUP_KE exchanges and the number of these exchanges will be determined by the number of additional key exchange methods used for the SA being rekeyed.</t>
      </section>
      <section anchor="ike-session-resumption">
        <name>IKE Session Resumption</name>
        <t>IKE Session Resumption <xref target="RFC5723"/> defines an IKEv2 extension, that allows peers to quickly restore IKE SA when it is for some reason deleted. When used with optimized rekey, the following rules apply.</t>
        <ul spacing="normal">
          <li>
            <t>Support for optimized rekeys <bcp14>MUST</bcp14> be re-negotiated during the resumption (in the IKE_AUTH exchange).</t>
          </li>
          <li>
            <t>If support for optimized rekey is negotiated during resumption, then all IKE SA algorithms, including key exchange methods, are taken from the resumption ticket (i.e., from the SA being resumed), since they are not negotiated in the IKE_SA_RESUME exchange.</t>
          </li>
          <li>
            <t>The initial Child SA created during the resumption is considered as been created with key exchange methods for the IKE SA, that were stored in the resumption ticket. This is despite the fact, that during the resumption no key exhanges (e.g., Diffie-Hellman) take place, the session keys are derived from the keys stored in the resumption ticket.</t>
          </li>
        </ul>
      </section>
    </section>
    <section anchor="iana-considerations">
      <name>IANA Considerations</name>
      <t>This document defines two new Notify Message Types in the "IKEv2 Notify Message Types - Status Types" registry. IANA is requested to assign codepoints in this registry.</t>
      <artwork><![CDATA[
NOTIFY messages: status types            Value
----------------------------------------------------------
OPTIMIZED_REKEY_SUPPORTED                TBD1
OPTIMIZED_REKEY                          TBD2
]]></artwork>
    </section>
    <section anchor="operational-considerations">
      <name>Operational Considerations</name>
      <t>Some implementations allow sending rekey messages with a different set of Traffic Selectors or cryptographic parameters in response to a configuration update. IKEv2 <xref target="RFC7296"/> states this "<bcp14>SHOULD NOT</bcp14>" be done. But if there is a configuration change that changes the Traffic Selectors, cryptographic parameters, or other properties of the SA, the regular rekey should be used to make the configuration change active, since the optimized rekey can't express such changes.</t>
      <t>Two peers' PFS policy and KE method configurations <bcp14>MUST</bcp14> be the same, otherwise, the rekey of the Child SA created in the IKE_AUTH exchange would fail. This issue is also discussed in detail in <xref target="I-D.pwouters-ipsecme-child-pfs-info"/>. If the KE method for Child SAs is negotiated during the creation of the initial Child SA via the mechanism like <xref target="I-D.pwouters-ipsecme-child-pfs-info"/>, this KE method <bcp14>MUST</bcp14> be inherited when using the optimized method to rekey the initial Child SA.</t>
    </section>
    <section anchor="security-considerations">
      <name>Security Considerations</name>
      <t>The optimized rekey removes sending unnecessary new parameters that originally would have to be validated against the original parameters. In that sense, this optimization enhances the security of the rekey process by reducing the complexity and code required.</t>
    </section>
    <section anchor="acknowledgments">
      <name>Acknowledgments</name>
      <t>Special thanks go to Antony Antony and Tobias Brunner.</t>
    </section>
  </middle>
  <back>
    <references anchor="sec-combined-references">
      <name>References</name>
      <references anchor="sec-normative-references">
        <name>Normative References</name>
        <reference anchor="RFC2119">
          <front>
            <title>Key words for use in RFCs to Indicate Requirement Levels</title>
            <author fullname="S. Bradner" initials="S." surname="Bradner"/>
            <date month="March" year="1997"/>
            <abstract>
              <t>In many standards track documents several words are used to signify the requirements in the specification. These words are often capitalized. This document defines these words as they should be interpreted in IETF documents. This document specifies an Internet Best Current Practices for the Internet Community, and requests discussion and suggestions for improvements.</t>
            </abstract>
          </front>
          <seriesInfo name="BCP" value="14"/>
          <seriesInfo name="RFC" value="2119"/>
          <seriesInfo name="DOI" value="10.17487/RFC2119"/>
        </reference>
        <reference anchor="RFC8174">
          <front>
            <title>Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words</title>
            <author fullname="B. Leiba" initials="B." surname="Leiba"/>
            <date month="May" year="2017"/>
            <abstract>
              <t>RFC 2119 specifies common key words that may be used in protocol specifications. This document aims to reduce the ambiguity by clarifying that only UPPERCASE usage of the key words have the defined special meanings.</t>
            </abstract>
          </front>
          <seriesInfo name="BCP" value="14"/>
          <seriesInfo name="RFC" value="8174"/>
          <seriesInfo name="DOI" value="10.17487/RFC8174"/>
        </reference>
        <reference anchor="RFC7296">
          <front>
            <title>Internet Key Exchange Protocol Version 2 (IKEv2)</title>
            <author fullname="C. Kaufman" initials="C." surname="Kaufman"/>
            <author fullname="P. Hoffman" initials="P." surname="Hoffman"/>
            <author fullname="Y. Nir" initials="Y." surname="Nir"/>
            <author fullname="P. Eronen" initials="P." surname="Eronen"/>
            <author fullname="T. Kivinen" initials="T." surname="Kivinen"/>
            <date month="October" year="2014"/>
            <abstract>
              <t>This document describes version 2 of the Internet Key Exchange (IKE) protocol. IKE is a component of IPsec used for performing mutual authentication and establishing and maintaining Security Associations (SAs). This document obsoletes RFC 5996, and includes all of the errata for it. It advances IKEv2 to be an Internet Standard.</t>
            </abstract>
          </front>
          <seriesInfo name="STD" value="79"/>
          <seriesInfo name="RFC" value="7296"/>
          <seriesInfo name="DOI" value="10.17487/RFC7296"/>
        </reference>
        <reference anchor="RFC5723">
          <front>
            <title>Internet Key Exchange Protocol Version 2 (IKEv2) Session Resumption</title>
            <author fullname="Y. Sheffer" initials="Y." surname="Sheffer"/>
            <author fullname="H. Tschofenig" initials="H." surname="Tschofenig"/>
            <date month="January" year="2010"/>
            <abstract>
              <t>The Internet Key Exchange version 2 (IKEv2) protocol has a certain computational and communication overhead with respect to the number of round trips required and the cryptographic operations involved. In remote access situations, the Extensible Authentication Protocol (EAP) is used for authentication, which adds several more round trips and consequently latency.</t>
              <t>To re-establish security associations (SAs) upon a failure recovery condition is time consuming especially when an IPsec peer (such as a VPN gateway) needs to re-establish a large number of SAs with various endpoints. A high number of concurrent sessions might cause additional problems for an IPsec peer during SA re-establishment.</t>
              <t>In order to avoid the need to re-run the key exchange protocol from scratch, it would be useful to provide an efficient way to resume an IKE/IPsec session. This document proposes an extension to IKEv2 that allows a client to re-establish an IKE SA with a gateway in a highly efficient manner, utilizing a previously established IKE SA.</t>
              <t>A client can reconnect to a gateway from which it was disconnected. The proposed approach encodes partial IKE state into an opaque ticket, which can be stored on the client or in a centralized store, and is later made available to the IKEv2 responder for re-authentication. We use the term ticket to refer to the opaque data that is created by the IKEv2 responder. This document does not specify the format of the ticket but examples are provided. [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="5723"/>
          <seriesInfo name="DOI" value="10.17487/RFC5723"/>
        </reference>
        <reference anchor="RFC9370">
          <front>
            <title>Multiple Key Exchanges in the Internet Key Exchange Protocol Version 2 (IKEv2)</title>
            <author fullname="CJ. Tjhai" initials="CJ." surname="Tjhai"/>
            <author fullname="M. Tomlinson" initials="M." surname="Tomlinson"/>
            <author fullname="G. Bartlett" initials="G." surname="Bartlett"/>
            <author fullname="S. Fluhrer" initials="S." surname="Fluhrer"/>
            <author fullname="D. Van Geest" initials="D." surname="Van Geest"/>
            <author fullname="O. Garcia-Morchon" initials="O." surname="Garcia-Morchon"/>
            <author fullname="V. Smyslov" initials="V." surname="Smyslov"/>
            <date month="May" year="2023"/>
            <abstract>
              <t>This document describes how to extend the Internet Key Exchange Protocol Version 2 (IKEv2) to allow multiple key exchanges to take place while computing a shared secret during a Security Association (SA) setup.</t>
              <t>This document utilizes the IKE_INTERMEDIATE exchange, where multiple key exchanges are performed when an IKE SA is being established. It also introduces a new IKEv2 exchange, IKE_FOLLOWUP_KE, which is used for the same purpose when the IKE SA is being rekeyed or is creating additional Child SAs.</t>
              <t>This document updates RFC 7296 by renaming a Transform Type 4 from "Diffie-Hellman Group (D-H)" to "Key Exchange Method (KE)" and renaming a field in the Key Exchange Payload from "Diffie-Hellman Group Num" to "Key Exchange Method". It also renames an IANA registry for this Transform Type from "Transform Type 4 - Diffie- Hellman Group Transform IDs" to "Transform Type 4 - Key Exchange Method Transform IDs". These changes generalize key exchange algorithms that can be used in IKEv2.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="9370"/>
          <seriesInfo name="DOI" value="10.17487/RFC9370"/>
        </reference>
      </references>
      <references anchor="sec-informative-references">
        <name>Informative References</name>
        <reference anchor="RFC5857">
          <front>
            <title>IKEv2 Extensions to Support Robust Header Compression over IPsec</title>
            <author fullname="E. Ertekin" initials="E." surname="Ertekin"/>
            <author fullname="C. Christou" initials="C." surname="Christou"/>
            <author fullname="R. Jasani" initials="R." surname="Jasani"/>
            <author fullname="T. Kivinen" initials="T." surname="Kivinen"/>
            <author fullname="C. Bormann" initials="C." surname="Bormann"/>
            <date month="May" year="2010"/>
            <abstract>
              <t>In order to integrate Robust Header Compression (ROHC) with IPsec, a mechanism is needed to signal ROHC channel parameters between endpoints. Internet Key Exchange (IKE) is a mechanism that can be leveraged to exchange these parameters. This document specifies extensions to IKEv2 that will allow ROHC and its associated channel parameters to be signaled for IPsec Security Associations (SAs). [STANDARDS-TRACK]</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="5857"/>
          <seriesInfo name="DOI" value="10.17487/RFC5857"/>
        </reference>
        <reference anchor="RFC9347">
          <front>
            <title>Aggregation and Fragmentation Mode for Encapsulating Security Payload (ESP) and Its Use for IP Traffic Flow Security (IP-TFS)</title>
            <author fullname="C. Hopps" initials="C." surname="Hopps"/>
            <date month="January" year="2023"/>
            <abstract>
              <t>This document describes a mechanism for aggregation and fragmentation of IP packets when they are being encapsulated in Encapsulating Security Payload (ESP). This new payload type can be used for various purposes, such as decreasing encapsulation overhead for small IP packets; however, the focus in this document is to enhance IP Traffic Flow Security (IP-TFS) by adding Traffic Flow Confidentiality (TFC) to encrypted IP-encapsulated traffic. TFC is provided by obscuring the size and frequency of IP traffic using a fixed-size, constant-send-rate IPsec tunnel. The solution allows for congestion control, as well as nonconstant send-rate usage.</t>
            </abstract>
          </front>
          <seriesInfo name="RFC" value="9347"/>
          <seriesInfo name="DOI" value="10.17487/RFC9347"/>
        </reference>
        <reference anchor="I-D.pwouters-ipsecme-child-pfs-info">
          <front>
            <title>IKEv2 support for Child SA PFS policy notification</title>
            <author fullname="Paul Wouters" initials="P." surname="Wouters">
              <organization>Aiven</organization>
            </author>
            <date day="3" month="March" year="2024"/>
            <abstract>
              <t>   This document defines the CHILD_PFS_INFO Notify Message Status Type
   Payload for the Internet Key Exchange Protocol Version 2 (IKEv2) to
   support exchanging the policy for the Perfect Forward Secrecy (PFS)
   and Key Exchange (KE) method setting of the initial Child SA.

              </t>
            </abstract>
          </front>
          <seriesInfo name="Internet-Draft" value="draft-pwouters-ipsecme-child-pfs-info-00"/>
        </reference>
      </references>
    </references>
    <?line 315?>



  </back>
  <!-- ##markdown-source:
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
VLvJMJA3yWwMDyENH2+EJoHxktZLKapzGFNkuGK8lCmGFmlIW52UW9QLb2AL
9k7A0Ox/sXk25kOVh3omIyEPcF9q22iwt8mQrr3cJ0KsL1JTdU40AZCvOKpK
3cppZnIfn2xsYAkRJJn5gQc96xI5lIbMSQNs+b0t+dZZOKooUZd92vN8kcup
Fkk/5XRM6NvzIf+7uZ4q6DXnM/jaENYc3kAoe1+kukVdraaZYLeMTJOYhBRT
YaPNs3VTrNyt8d0cRSEJ+JxsmDkRdBC1HQJXk8H19LI3mqAEXZ9f9AdtNpiM
r6enJ9fjXr8/HL28Hl1MSxlrs8uLVyeezL0zvTXvsWiMy/Vevjy97L2kF9ho
857ZSqS1J/9IHt9KeRvkH08X2psJ5NYo4B1Y+fb7v18gAPtDFu/FAqdGA7T6
RaXEkkDVnBink67cGHA7BWM8x7490b3ptl0RBN2mLq/QeRdMRINLwi2NUfWO
HOC1NbGwppcJl0eudCpCJxkWKqr7ZNT0oe1rdaqPnIlGTeGGwndKgk0pK7T6
jWqo55KXr1JGizIYNJ3OU6sGJYzOX9WyTwvFFyHaNRUHd0SKTi0pcpony4PJ
tjvksRbU+MZt7tWuUwk4upt71Tdyttwr0m1jkvSct0dSSn+NQbvPQX4hNjVU
2PR/4mOTzERcJKCb27mSswvFPo8OoQR7nGFE5Tzd55MCzZ/MC60rpmSjqHKq
KuUIX95MEQCnF/a0cHvVsn7qWfczHr4lSakohC7Ltpfdw6E20wYBlEzIpe6b
qjEPwpION409KHTotBKFRWyZa0eSCSz8os0RWYYRgipL8649Yo7NIQKczvX4
8mJ8MemdgZe5mAxGXaYLLSUIdC5AK7kjj2b866dAyAOsma29EKkk1DcQBGtp
OqWwQZkTT2e8f9HW+5eN+M16x+1VxFoPEKFawd+2Khqh2hJOIdfccZiOCr/g
UKxbOuBGD3PY8Oyo4dlDmH8Ao4/YQ/aIPWY/sCfsKXv2Jc92Wg9qPvpB50Ht
9/2fBzutj2yEVTbLNfbx5COEDoPJ4PINkBx+O4jtkDMR34DQms/Hvw0U7mbL
sL/3Lwf7Hym+nODZCv60UNQkgJoHtkNx/+8GKGxA8B3zwGF7hywJcpHvs46L
Wg+6OKqEsWlIm4qxqGuQDuNQEE/Ml3Qo+F0jMntHeiHlr4S9hyY4XvKoEOzX
6Yv+4a9lw12TYpiklWqikKny7hZFvF/7Gpf2OoJtslHJZbf15Piqc/D/ivMP
pDgf2dd9AIo/7ns/MkWMez5//E2g+BSun/p8sRH5tBnRwdzu/d1du2wuReSK
Zias0eGTPZO2wautCKE50s3Cpra1O/KdKba0mmUNnF9nsI5+dQnwxj5lpmHK
V6X10sBi3UvppsqQKlLK1qPIImELTP1ADFu0KYF25zsulgIQnxqwK8PKxvdy
IMRpZfew45Shdlwt+VSCEUoebTGl7Feon9qZGxuCmtRhmi5dUhfCALslsbpm
g6hz24bidxDSy3fmGtB707Wotys0Wq57pdJJoaN1LzUrMjz888jlN28wCFb5
LJLqllrAZKxhBPJ9an3MVt1VHPATk54pxdaDLAo/QQRgMyK+Pe6jFKppaSqG
1m431GsrtqvZb5tXyUK3KJxenJ1dvL0aX3vZuyr1pFjMdKVWF5LKEXbRENVw
QU2iJuQs5/AwlKZFspEsjiRb5YJYTqwwNdZLYduBKSVpfKMLU0+OHpaSwGN3
+8jIU5vZrvlkpUwODxIOSW5wF1Gml2PjihGDle2o0rJC1NP9Jvr6Aeqaade1
pffGFEKzgLAsIoQrTaO1wfS7SgtbbXpZls9ExyvFhGXnU1YSYG9bw9m+MWPD
+b39S7JS7jF7lOsb4cWKp1UTd1+ibTJrnNHE9LZuneR3sIBLhT3Qc0mXCfZk
V0C66EZ40gFDRbjfxlsR+p7EuqEa5De1TXoQyE2uzksBN1Qoj7e8gpetuDZT
VvfcKbwPo+tE1MFUOXO518Joehnhw3tsjOTMwbtBCdP0iyUESN6kTtcg9Q5y
s0gznBDxajiMupp6XF/OwRB3XokoWvB4n/igPaCWT2WUiSQOqQp4Srzj4RhB
bz4FszHpvVEP24GJWroI1nQr0thqczTQ4GDd/xBgV+tw45AOm+Q8L5T+uYtp
ObaUrbsaDFPBAq22t9/wfgTdYqWbIMqFCm5iGamPLqbD059tjVrhxX/aKqed
vc8b9PRfU2reaW1P/WsfzH82hm8P7DD6qB79Gp6g7G/waIIGDu+dUH+2KWCS
rXQ3MGybkqaJLeKUdS5zW2zzfhXWTyp3Hr2CqIzLUgxyqVbT0geO9rJieT8T
+SFMp6zf8E0OKolhxosir3TJNFfLzPGJ0RkUuQ3w21uBbyNm23uVmhqCakU4
wBib+ytlxQp4nI7LPNO3YbkDHn+bg9rToaQ+6ym7l7x69be6xJZEMljX6s+1
srX1OzYMaWscV1IJi5KLXMSmGd3a+qxPGrGG6EycKjRvsCAfShUUysTwEGTA
OPz222/lJe3ff6fQa7PWX6m8NjtLd/Rg4N5wA0vJ6cVCILxSLVgkgTXV/U1x
ttx980TPuw9S5Vd5GVATsAkKY0hd3tNkTJtKrotkKcq7UgXefkM9zdZkYj19
I3n37gNqpuhjDDoUgdxF6kN+foPJiOmRNTP82x/6OiinRhAtGmXbuia1iIGS
gVEsdwXX3dpE0G0lma6je9exvIvk+l556F3k0UTqBXdxsopEeENXSsiK6cvl
zFxwukkQqV6cJ/Ha/qHD/mQmwZO/yJBQmbtPPuPB3U7rvwE6qTwqqUYAAA==

-->

</rfc>
